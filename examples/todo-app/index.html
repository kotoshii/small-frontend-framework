<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Todo App Example</title>
    <script src=></script>
</head>
<body>
    <script type="module">
      import {
        createApp,
        fragment,
        h,
      } from '../../dist/runtime/sff.js';

      class TodoItem extends Component {
        render() {
          return h('li', {}, [this.props.todo, new Date().toString()])
        }
      }

      class App extends Component {
        constructor(props) {
          super(props);
          console.log('render')
        }

        state = {
          inputValue: '',
        }

        handleButtonClick = () => {
          this.props.store.dispatch('addTodo', this.state.inputValue)
          this.setInputValue('');
        }

        setInputValue(value) {
          console.log(value)
          this.setState({ inputValue: value })
        }

        render() {
          const { inputValue } = this.state
          const { data: { todos } } = this.props.store;
          return fragment([
            h('h1', {}, ['Todo list']),
            h(
              'ul',
              {},
              todos.map((todo) => h(TodoItem, { todo })),
            ),
            h('input', {
              placeholder: 'Enter todo text...',
              type: 'text',
              on: {
                input: (event) => this.setInputValue(event.target.value),
              },
              value: inputValue,
            }),
            h('button', { on: { click: this.handleButtonClick } }, ['Add todo']),
          ]);
        }
      }

      createApp({
        state: {
          todos: [],
        },
        reducers: {
          addTodo: (state, payload) => ({
            ...state,
            todos: [...state.todos, payload],
          }),
        },
        view: App,
      }).mount(document.body);
    </script>
</body>
</html>